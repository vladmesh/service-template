"""Pytest configuration for {{ project_name }}.

This file contains shared fixtures and configuration for all tests.
"""

from collections.abc import Generator
import os

import pytest
{%- if 'tg_bot' in modules or 'notifications' in modules %}

try:
    from redis import Redis

    HAS_REDIS = True
except ImportError:
    HAS_REDIS = False
{%- endif %}
{% if 'tg_bot' in modules or 'notifications' in modules %}
if HAS_REDIS:

    @pytest.fixture(scope="session")
    def test_redis_url() -> str:
        """Get test Redis URL from environment."""
        return os.getenv("TEST_REDIS_URL", "redis://localhost:6379/15")

    @pytest.fixture
    def redis_client(test_redis_url: str) -> Generator[Redis, None, None]:
        """Create a test Redis client with automatic cleanup."""
        client = Redis.from_url(test_redis_url, decode_responses=True)
        yield client
        client.flushdb()
        client.close()
{% endif %}
# Add your custom fixtures below
