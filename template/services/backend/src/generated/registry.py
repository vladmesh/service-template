# AUTO-GENERATED BY SERVICE-TEMPLATE - DO NOT EDIT
"""
Registry for backend service.

Provides auto-registration of all generated routers and event adapters.
"""
from __future__ import annotations

from collections.abc import Callable

from fastapi import APIRouter
from sqlalchemy.ext.asyncio import AsyncSession

from .protocols import (
    DebugControllerProtocol,
    UsersControllerProtocol,
)
from .routers.debug import create_router as create_debug_router
from .routers.users import create_router as create_users_router


def create_api_router(
    get_db: Callable[[], AsyncSession],
    get_users_controller: Callable[[], UsersControllerProtocol],
    get_debug_controller: Callable[[], DebugControllerProtocol],
) -> APIRouter:
    """Create and configure the API router with all domain routers.

    Args:
        get_db: Dependency to get DB session.
        get_users_controller: Factory for users controller.
        get_debug_controller: Factory for debug controller.

    Returns:
        Configured APIRouter with all domain routers included.
    """
    router = APIRouter()

    router.include_router(
        create_users_router(get_db, get_users_controller)
    )
    router.include_router(
        create_debug_router(get_db, get_debug_controller)
    )

    return router


# Re-export protocols for convenient imports
__all__ = [
    "create_api_router",
    "DebugControllerProtocol",
    "UsersControllerProtocol",
]
