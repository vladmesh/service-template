domain: users
config:
  rest:
    prefix: "/users"
    tags: ["users"]

operations:
  # Dual-transport: REST endpoint that also publishes an event
  create_user:
    input: UserCreate
    output: UserRead
    rest:
      method: POST
      path: ""
      status: 201
    events:
      publish_on_success: user_registered  # Published after successful creation

  get_user:
    output: UserRead
    params:
      - name: user_id
        type: int
    rest:
      method: GET
      path: "/{user_id}"

  update_user:
    input: UserUpdate
    output: UserRead
    params:
      - name: user_id
        type: int
    rest:
      method: PUT
      path: "/{user_id}"

  delete_user:
    params:
      - name: user_id
        type: int
    rest:
      method: DELETE
      path: "/{user_id}"
      status: 204
