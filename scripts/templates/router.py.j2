# AUTO-GENERATED BY SERVICE-TEMPLATE - DO NOT EDIT
"""
Router for {{ module_name }}.
"""
# AUTO-GENERATED FROM shared/spec/rest.yaml â€“ DO NOT EDIT MANUALLY

from __future__ import annotations

from typing import Annotated, Optional
from uuid import UUID

from fastapi import APIRouter, Query, Path, Body, Depends
from pydantic import BaseModel
from sqlalchemy.orm import Session

from services.backend.src.app.api.deps import get_db

{% if imports %}
from shared.generated.schemas import (
    {% for model in imports|sort %}
    {{ model }},
    {% endfor %}
)
{% endif %}
# Import the controller. 
# Note: We assume the controller module is named after the router but located in
# services.backend.src.controllers. This might need adjustment if we support multiple services.
from services.backend.src.controllers import {{ module_name }} as controller

router = APIRouter(
    {% if prefix %}prefix="{{ prefix }}",{% endif %}
    {% if tags %}tags={{ tags }},{% endif %}
)

{% for handler in handlers %}
@router.{{ handler.method|lower }}(
    "{{ handler.path }}",
    {% if handler.response_model %}response_model={{ handler.response_model }},{% endif %}
    status_code={{ handler.status_code }},
    {% if handler.tags %}tags={{ handler.tags }},{% endif %}
)
{% if async_handlers %}async {% endif %}def {{ handler.name }}(
    session: Annotated[Session, Depends(get_db)],
    {% for param in handler.params %}
    {{ param.name }}: Annotated[{{ param.type }}, {{ param.source }}],
    {% endfor %}
    {% if handler.request_model %}
    payload: Annotated[{{ handler.request_model }}, Body(...)],
    {% endif %}
) -> {{ handler.return_type }}:
    """{{ handler.docstring }}"""
    return await controller.{{ handler.name }}(
        session=session,
        {% for param in handler.params %}
        {{ param.name }}={{ param.name }},
        {% endfor %}
        {% if handler.request_model %}
        payload=payload,
        {% endif %}
    )

{% endfor %}
