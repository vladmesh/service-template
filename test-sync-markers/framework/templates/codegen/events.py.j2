# Generated by framework - DO NOT EDIT
import os
from typing import Any

from faststream.redis import RedisBroker
from faststream.redis.parser import BinaryMessageFormatV1

{% if imports %}
from shared.generated.schemas import {{ imports | join(', ') }}
{% endif %}

redis_url = os.getenv("REDIS_URL")
if not redis_url:
    raise RuntimeError("REDIS_URL is not set; please add it to your environment variables")
broker = RedisBroker(redis_url, message_format=BinaryMessageFormatV1)

{% for pub in publishers %}
_publisher_{{ pub.name }} = broker.publisher("{{ pub.name }}")

async def publish_{{ pub.name }}(message: {{ pub.message_model }}) -> Any:
    """Publish {{ pub.message_model }} to channel '{{ pub.name }}'."""
    return await _publisher_{{ pub.name }}.publish(message)
{% endfor %}
