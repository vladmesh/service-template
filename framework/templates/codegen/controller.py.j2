from __future__ import annotations

{% if async_handlers %}
from sqlalchemy.ext.asyncio import AsyncSession
{% else %}
from sqlalchemy.orm import Session
{% endif %}

from ..generated.protocols import {{ protocol_name }}

{% if imports %}
from shared.generated.schemas import (
    {% for model in imports|sort %}
    {{ model }},
    {% endfor %}
)
{% endif %}

class {{ module_name.capitalize() }}Controller({{ protocol_name }}):
    """
    Implementation of {{ protocol_name }}.
    """
    {% for handler in handlers %}
    {% if async_handlers %}async {% endif %}def {{ handler.name }}(
        self,
        session: {% if async_handlers %}AsyncSession{% else %}Session{% endif %},
        {% for param in handler.params %}
        {{ param.name }}: {{ param.type }},
        {% endfor %}
        {% if handler.request_model %}
        payload: {{ handler.request_model }},
        {% endif %}
    ) -> {{ handler.return_type }}:
        """
        {{ handler.docstring }}
        """
        raise NotImplementedError("Method {{ handler.name }} not implemented")

    {% endfor %}
