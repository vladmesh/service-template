# Generated by scripts/generate_from_spec.py - DO NOT EDIT
import os
from typing import Any

from faststream.redis import RedisBroker

{% if imports %}
from shared.generated.schemas import {{ imports | join(', ') }}
{% endif %}

redis_url = os.getenv("REDIS_URL")
if not redis_url:
    raise RuntimeError("REDIS_URL is not set; please add it to your environment variables")
broker = RedisBroker(redis_url)

{% for event in events %}
{% if event.publish %}
_publisher_{{ event.name }} = broker.publisher("{{ event.name }}")

async def publish_{{ event.name }}(message: {{ event.message }}) -> Any:
    """Publish {{ event.message }} to channel '{{ event.name }}'."""
    return await _publisher_{{ event.name }}.publish(message)
{% endif %}
{% endfor %}
