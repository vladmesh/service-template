##############################################################################
# THIS FILE IS GENERATED BY THE FRAMEWORK. DO NOT EDIT MANUALLY.
# CHANGES WILL BE OVERWRITTEN.
##############################################################################
# AUTO-GENERATED BY SERVICE-TEMPLATE - DO NOT EDIT
"""
Router for debug.
"""
# AUTO-GENERATED FROM shared/spec/rest.yaml â€“ DO NOT EDIT MANUALLY

from __future__ import annotations

from collections.abc import Callable

from fastapi import APIRouter, Body, Depends, Path, Query  # noqa: F401
from shared.generated.schemas import (
    CommandReceived,
    CommandReceivedCreate,
)
from sqlalchemy.ext.asyncio import AsyncSession

from ..protocols import DebugControllerProtocol


def create_router(
    get_db: Callable[[], AsyncSession],
    get_controller: Callable[[], DebugControllerProtocol],
) -> APIRouter:
    """
    Create and configure the debug router.

    Args:
        get_db: Dependency to get DB session
        get_controller: Dependency to get controller implementation

    Returns:
        Configured APIRouter instance
    """
    router = APIRouter(
        prefix="/debug",
        tags=["debug"],
    )

    @router.post(
        "/command",
        response_model=CommandReceived,
        status_code=202,
    )
    async def command(
        payload: CommandReceivedCreate = Body(...),  # noqa: B008
        session: AsyncSession = Depends(get_db),  # noqa: B008
        controller: DebugControllerProtocol = Depends(get_controller),  # noqa: B008
    ) -> CommandReceived:
        """Handler for command"""
        return await controller.command(
            session=session,
            payload=payload,
        )

    return router
